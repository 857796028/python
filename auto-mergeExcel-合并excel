#获取固定文件夹路径下的所有文件名
#注意，遍历所有文件夹下的文件
import os
import pandas as pd
def get_file(root_path,all_files=[]):
    '''
    递归函数，遍历该文档目录和子目录下的所有文件，获取其path
    '''
    files = os.listdir(root_path)
    for file in files:
        if not os.path.isdir(root_path + '/' + file):   # not a dir
            all_files.append(root_path + '/' + file)
        else:  # is a dir
            get_file((root_path+'/'+file),all_files)
    return all_files

# 指定要获取的目录
path = 'D:/To_study_excel/merge_to_raw_data'
print(get_file(path))
df = pd.DataFrame(get_file(path),columns=['已经上交的名单'])
    #df.to_excel("company_name_li.xlsx", index=False) 保存到本地路径
df.to_excel("D:/To_study_excel/merge_to_result/total_for.xlsx",index=False)
print("程序正常运行结束！！！！")


"""
import os
import pandas as pd
    #获取指定目录下的文件夹
filePath = 'D:\\To_study_excel\\merge_to_raw_name\\'
os.listdir(filePath)
for i,j,k in os.walk(filePath):
    print(i)
    print(j)
    print(k)
    print(type(k))
    df = pd.DataFrame(k,columns=['已经上交的名单'])
    #df.to_excel("company_name_li.xlsx", index=False) 保存到本地路径
    df.to_excel("D:/To_study_excel/merge_to_result/合计上交的名单.xlsx",index=False)
    print("程序运行结束！！！！")
    """
